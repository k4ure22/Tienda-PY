{% load static %}

<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <title>Centro de Solicitudes</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Poppins', sans-serif;
    }
  </style>
</head>

<body class="bg-gray-100 text-gray-800">
  <!-- Header -->
  <header class="bg-white shadow-md fixed top-0 left-0 w-full z-50">
    <div class="max-w-7xl mx-auto px-6 py-4 flex items-center justify-between">
      <!-- Logo + buscador -->
      <div class="flex items-center gap-6">
        <h2 class="text-xl font-bold text-indigo-600">Computadores</h2>
        <form action="{% url 'productos' %}" method="get" class="relative">
          <input type="text" name="q" placeholder="Buscar productos..." value="{{ query|default_if_none:'' }}"
            class="pl-4 pr-10 py-2 border rounded-full focus:outline-none focus:ring-2 focus:ring-indigo-500 w-64 bg-gray-50">
          <button type="submit"
            class="absolute right-2 top-1/2 -translate-y-1/2 text-gray-500 hover:text-indigo-600">üîç</button>
        </form>

      </div>

      <!-- T√≠tulo -->
      <span class="text-lg font-semibold hidden md:block">Productos</span>

      <!-- Usuario / sesi√≥n -->
      <div class="flex items-center gap-4">
        <a href="{% url 'solicitudes' %}" class="relative text-xl hover:text-indigo-600">üîî</a>
        {% if request.user.is_authenticated %}
        <a href="{% url 'perfil_usuario' request.user.id %}"
          class="flex items-center gap-2 bg-gray-100 rounded-full px-3 py-1 hover:bg-gray-200">
          {% if request.user.foto_perfil %}
          <img src="{{ request.user.foto_perfil.url }}" class="w-8 h-8 rounded-full" alt="Foto de perfil">
          {% else %}
          <img src="{% static 'core/img/default-user.png' %}" class="w-8 h-8 rounded-full" alt="Foto de perfil">
          {% endif %}
          <span class="font-medium">{{ request.user.nombre|default:request.user.email }}</span>
        </a>
        <a href="{% url 'logout' %}" class="bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600">Cerrar
          sesi√≥n</a>
        {% else %}
        <a href="{% url 'login' %}" class="bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700">Iniciar
          sesi√≥n</a>
        {% endif %}
      </div>
    </div>
  </header>

  <!-- Contenido -->
  <main class="pt-28 max-w-6xl mx-auto px-6">
    <div class="flex justify-between items-center mb-6">
      <h1 class="text-2xl font-bold text-gray-800">Centro de Notificaciones</h1>
      <a href="{% url 'productos' %}" class="text-indigo-600 hover:underline">‚¨Ö Volver</a>
    </div>

    <div class="grid md:grid-cols-2 gap-8">

      <!-- Solicitudes de compra -->

      <div class="bg-white rounded-2xl shadow-md p-6">
        <h2 class="text-xl font-semibold text-gray-800 mb-4">Solicitudes de Compra</h2>
        {% if solicitudes_compra %}
        <ul class="space-y-4">
          {% for v in solicitudes_compra %}
          <li class="border-b pb-4">
            <p><strong>{{ v.cliente_nombre }}</strong> - {{ v.producto.marca }} {{ v.producto.modelo }}</p>
            <p>C√©dula: {{ v.cliente_cedula }}</p>
            <p>Tel√©fono: {{ v.cliente_telefono }}</p>
            <p class="text-sm text-gray-500">Fecha: {{ v.fecha|date:"d/m/Y H:i" }}</p>
          </li>
          {% endfor %}
        </ul>
        {% else %}
        <p class="text-gray-500">No hay solicitudes de compra.</p>
        {% endif %}
      </div>
      <!-- Solicitudes de registro -->
      <div class="bg-white rounded-2xl shadow-md p-6">
        <h2 class="text-xl font-semibold text-gray-800 mb-4">Solicitudes de Registro</h2>
        {% if solicitudes_registro %}
        <ul class="space-y-4">
          {% for s in solicitudes_registro %}
          <li class="border-b pb-4">
            <p><strong>{{ s.nombres }}</strong> ({{ s.cargo }})</p>
            <p>ID: {{ s.tipo_identificacion }} {{ s.numero_identificacion }}</p>
            <p>Correo: {{ s.correo }}</p>
            <p>Tel√©fono: {{ s.telefono }}</p>
            <p class="text-sm text-gray-500">Fecha: {{ s.fecha_solicitud|date:"d/m/Y H:i" }}</p>
            <div class="mt-3 flex gap-3">
              <a href="{% url 'registrar_desde_solicitud' s.id %}"
                class="bg-green-500 text-white px-4 py-2 rounded-lg hover:bg-green-600">Registrar ahora</a>
              <a href="{% url 'rechazar_solicitud' s.id %}"
                class="bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600">Rechazar</a>
            </div>
          </li>
          {% endfor %}
        </ul>
        {% else %}
        <p class="text-gray-500">No hay solicitudes de registro.</p>
        {% endif %}
      </div>

    </div>
  </main>
</body>

</html>