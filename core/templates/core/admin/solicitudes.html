{% load static %}
<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <title>Centro de Solicitudes</title>
  <link rel="stylesheet" href="{% static 'core/general.css' %}">
  <link rel="stylesheet" href="{% static 'core/notis.css' %}">


</head>

<body>
  <header class="topbar">
    <div class="topbar-left">
      <h2 class="topbar-logo">Computadores</h2>

      <form action="{% url 'productos' %}" method="get" class="topbar-search">
        <input type="text" name="q" placeholder="Buscar productos..." value="{{ query|default_if_none:'' }}">
        <button type="submit">üîç</button>
      </form>
    </div>

    <div class="topbar-center">
      <span class="topbar-title">Productos</span>
    </div>

    <div class="topbar-right">
      <a href="{% url 'solicitudes' %}" class="icon-btn" title="Notificaciones">üîî</a>

      {% if request.user.is_authenticated %}
      <a href="{% url 'perfil_usuario' request.user.id %}" class="user-chip">
        {% if request.user.foto_perfil %}
        <img src="{{ request.user.foto_perfil.url }}" alt="Foto de perfil" class="avatar">
        {% else %}
        <img src="{% static 'core/img/default-user.png' %}" alt="Foto de perfil" class="avatar">
        {% endif %}
        <span class="user-name">{{ request.user.nombre|default:request.user.email }}</span>
      </a>
      <a href="{% url 'logout' %}" class="pill pill-red">Cerrar sesi√≥n</a>
      {% else %}
      <a href="{% url 'login' %}" class="pill">Iniciar sesi√≥n</a>
      {% endif %}
    </div>
  </header>
  <h1>Centro de Notificaciones</h1>
  
    <a href="{% url 'productos' %}" class="btn-volver">‚¨Ö Volver</a>

  <div class="container">


    <div class="card">
      <h2>Solicitudes de Registro</h2>
      {% if solicitudes_registro %}
      <ul>
        {% for s in solicitudes_registro %}
        <li>
          <strong>{{ s.nombres }}</strong> ({{ s.cargo }}) <br>
          Identificaci√≥n: {{ s.tipo_identificacion }} {{ s.numero_identificacion }} <br>
          Correo: {{ s.correo }} <br>
          Tel√©fono: {{ s.telefono }} <br>
          Fecha: {{ s.fecha_solicitud|date:"d/m/Y H:i" }}

          <br>
          <a href="{% url 'registrar_desde_solicitud' s.id %}">
            <button>Registrar ahora</button>
          </a>

          <a href="{% url 'rechazar_solicitud' s.id %}">
            <button style="background:red; color:white;">Rechazar</button>
          </a>
        </li>
        <hr>

        {% endfor %}
      </ul>
      {% else %}
      <p>No hay solicitudes de registro.</p>
      {% endif %}
    </div>


    <div class="card">
      <h2>Solicitudes de Compra</h2>
      {% if solicitudes_compra %}
      <ul>
        {% for v in solicitudes_compra %}
        <li>
          <strong>{{ v.cliente_nombre }}</strong> - {{ v.producto.marca }} {{ v.producto.modelo }} <br>
          C√©dula: {{ v.cliente_cedula }} <br>
          Tel√©fono: {{ v.cliente_telefono }} <br>
          Fecha: {{ v.fecha|date:"d/m/Y H:i" }}
        </li>
        {% endfor %}
      </ul>
      {% else %}
      <p>No hay solicitudes de compra.</p>
      {% endif %}
    </div>

  </div>

</body>

</html>